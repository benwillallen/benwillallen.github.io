library(forecast)
plot(model_1950)
plot(full_model)
View(FEDFUNDS)
autoplot(cpi_1950$Inf_Rate)
auto.arima(cpi_1950$Inf_Rate)
summary(auto.arima(cpi_1950$Inf_Rate))
auto.arima(cpi_1950$Inf_Rate, seasonal = FALSE)
auto.arima(cpi_1950$Inf_Rate)
install.packages("vars")
library(vars)
VAR(y=cpi_full$Inf_Rate, exogen=cpi_full[2:8])
View(cpi_full)
VAR(y=c(cpi_full$Inf_Rate, cpi_full$Fed_Rate), exogen=cpi_full[3:8])
VAR(y=c(cpi_full$Inf_Rate, cpi_full$Fed_Rate), exogen=cpi_full[3:8])
VAR(y=matrix(cpi_full$Inf_Rate, cpi_full$Fed_Rate), exogen=cpi_full[3:8])
VAR(y=matrix(cpi_full$Inf_Rate, cpi_full$Fed_Rate, byrow = TRUE), exogen=cpi_full[3:8])
VAR(y=matrix(cpi_full$Inf_Rate, cpi_full$Fed_Rate, byrow = FALSE), exogen=cpi_full[3:8])
View(cpi_1950)
auto.arima(cpi_1950$Inf_Rate, xreg=cpi_1950[4:6])
auto.arima(cpi_1950$Inf_Rate, xreg=as.matrix(cpi_1950[4:6]))
plot(auto.arima(cpi_1950$Inf_Rate, xreg=as.matrix(cpi_1950[4:6])))
fit <- auto.arima(cpi_1950$Inf_Rate, xreg=as.matrix(cpi_1950[4:6]))
View(fit)
autoplot(forecast(fit, h=30))
autoplot(forecast(fit))
fit <- auto.arima(cpi_1950$Inf_Rate)
autoplot(forecast(fit))
autoplot(forecast(fit, h=30))
autoplot(forecast(fit, h=100))
fit <- auto.arima(cpi_full$Inf_Rate)
autoplot(forecast(fit, h=100))
autoplot(forecast(fit, h=20))
autoplot(forecast(fit, h=20, model=Arima))
autoplot(forecast(fit, h=20))
fit <- auto.arima(cpi_1950$Inf_Rate, xreg=as.matrix(cpi_1950[4:6]))
autoplot(forecast(fit, h=20))
autoplot(forecast(fit, h=30))
fit <- auto.arima(cpi_full$Inf_Rate)
autoplot(forecast(fit, h=30))
fit <- auto.arima(cpi_full$Inf_Rate)
summary(fit)
summary(auto.arima(cpi_1950$Inf_Rate, xreg=as.matrix(cpi_1950[4:6])))
plot(cpi_full$Inf_Rate, cpi_full$Fed_Rate)
plot(lag(cpi_full$Inf_Rate), cpi_full$Fed_Rate)
plot(lag(cpi_full$Inf_Rate, 2), cpi_full$Fed_Rate)
plot(lag(cpi_full$Inf_Rate, 10), cpi_full$Fed_Rate)
plot(lag(cpi_full$Inf_Rate, 30), cpi_full$Fed_Rate)
plot(lag(cpi_full$Inf_Rate, 40), cpi_full$Fed_Rate)
plot(lag(cpi_full$Inf_Rate, 1), cpi_full$Fed_Rate)
plot(cpi_full$Fed_Rate, cpi_full$Inf_Rate)
plot(cpi_1950$Fed_Rate, cpi_1950$Inf_Rate)
plot(lag(cpi_1950$Fed_Rate), cpi_1950$Inf_Rate)
plot(lag(cpi_1950$Fed_Rate, 3), cpi_1950$Inf_Rate)
plot(lag(cpi_1950$Fed_Rate, 12), cpi_1950$Inf_Rate)
plot(lag(cpi_1950$Fed_Rate, 24), cpi_1950$Inf_Rate)
plot(lag(cpi_1950$Fed_Rate, 36), cpi_1950$Inf_Rate)
plot(lag(cpi_1950$Fed_Rate, 48), cpi_1950$Inf_Rate)
plot(lag(cpi_1950$Fed_Rate, 1), cpi_1950$Inf_Rate)
plot(lag(cpi_1950$Fed_Rate, 100), cpi_1950$Inf_Rate)
plot(lag(cpi_1950$Fed_Rate, 12), cpi_1950$Inf_Rate)
plot(lag(cpi_1950$Fed_Rate, 1), cpi_1950$Inf_Rate)
plot(lag(cpi_full$Fed_Rate, 1), cpi_full$Inf_Rate)
plot(lag(cpi_full$Fed_Rate, 12), cpi_full$Inf_Rate)
plot(lag(cpi_full$Fed_Rate, 24), cpi_full$Inf_Rate)
plot(lag(cpi_full$Fed_Rate, 36), cpi_full$Inf_Rate)
plot(lag(cpi_full$Fed_Rate, 48), cpi_full$Inf_Rate)
plot(lag(cpi_full$Fed_Rate, 60), cpi_full$Inf_Rate)
plot(lag(cpi_full$Fed_Rate, 12), cpi_full$Inf_Rate)
ggplot(data=cpi_1950) +
geom_line(mapping=aes(x=1:length(`Fed_Rate`), y=`Fed_Rate`))
ggplot(data=cpi_1950) +
geom_line(mapping=aes(x=1:length(`Fed_Rate`), y=`Fed_Rate`)) +
geom_line(mapping=aes(x=1:length(`Inf_Rate`), y=`Inf_Rate`))
ggplot(data=cpi_1950) +
geom_line(mapping=aes(x=1:length(`Fed_Rate`), y=`Fed_Rate`), col="blue") +
geom_line(mapping=aes(x=1:length(`Inf_Rate`), y=`Inf_Rate`))
ggplot(data=cpi_1950) +
geom_line(mapping=aes(x=1:length(`Fed_Rate`), y=`Fed_Rate`), col="blue") +
geom_line(mapping=aes(x=1:length(`Inf_Rate`), y=`Inf_Rate`), col="red")
ggplot(data=cpi_1950) +
geom_line(mapping=aes(x=1:length(`Fed_Rate`), y=`Fed_Rate`), col="blue") +
geom_line(mapping=aes(x=1:length(`Inf_Rate`), y=`Inf_Rate`), col="red") +
theme_bw()
ggplot(data=cpi_1950) +
geom_line(mapping=aes(x=1:length(lag(`Fed_Rate`)), y=`Fed_Rate`), col="blue") +
geom_line(mapping=aes(x=1:length(lag(`Fed_Rate`)), y=`Inf_Rate`), col="red") +
theme_bw()
ggplot(data=cpi_1950) +
geom_line(mapping=aes(x=1:length(lag(`Fed_Rate`, 12)), y=`Fed_Rate`), col="blue") +
geom_line(mapping=aes(x=1:length(lag(`Fed_Rate`)), y=`Inf_Rate`), col="red") +
theme_bw()
ggplot(data=cpi_1950) +
geom_line(mapping=aes(x=1:length(lag(`Fed_Rate`, 12)), y=lag(`Fed_Rate`, 12)), col="blue") +
geom_line(mapping=aes(x=1:length(lag(`Fed_Rate`)), y=`Inf_Rate`), col="red") +
theme_bw()
ggplot(data=cpi_1950) +
geom_line(mapping=aes(x=1:length(lag(`Fed_Rate`, 12)), y=lag(`Fed_Rate`, 12)), col="blue") +
geom_line(mapping=aes(x=1:length(lag(`Fed_Rate`, 12)), y=`Inf_Rate`), col="red") +
theme_bw()
ggplot(data=cpi_1950) +
geom_line(mapping=aes(x=1:length(lag(`Fed_Rate`, 12)), y=lag(`Fed_Rate`, 24)), col="blue") +
geom_line(mapping=aes(x=1:length(lag(`Fed_Rate`, 12)), y=`Inf_Rate`), col="red") +
theme_bw()
ggplot(data=cpi_1950) +
geom_line(mapping=aes(x=1:length(lag(`Fed_Rate`, 24)), y=lag(`Fed_Rate`, 24)), col="blue") +
geom_line(mapping=aes(x=1:length(lag(`Fed_Rate`, 24)), y=`Inf_Rate`), col="red") +
theme_bw()
ggplot(data=cpi_1950, mapping=aes(x=1:length(lag(`Fed_Rate`, 24)))) +
geom_line(mapping=aes(y=lag(`Fed_Rate`, 24)), col="blue") +
geom_line(mapping=aes(y=`Inf_Rate`), col="red") +
theme_bw()
ggplot(data=cpi_1950, mapping=aes(x=1:length(lag(`Fed_Rate`, 24)))) +
geom_line(mapping=aes(y=lag(`Fed_Rate`, 24)), col="blue") +
geom_line(mapping=aes(y=lag(`Fed_Rate`, 1)), col="green") +
geom_line(mapping=aes(y=`Inf_Rate`), col="red") +
theme_bw()
ggplot(data=cpi_1950, mapping=aes(x=1:length(lag(`Fed_Rate`, 24)))) +
geom_line(mapping=aes(y=lag(`Fed_Rate`, 24)), col="blue", alpha=0.5) +
geom_line(mapping=aes(y=lag(`Fed_Rate`, 1)), col="green") +
geom_line(mapping=aes(y=`Inf_Rate`), col="red") +
theme_bw()
ggplot(data=cpi_1950, mapping=aes(x=1:length(lag(`Fed_Rate`, 24)))) +
geom_line(mapping=aes(y=lag(`Fed_Rate`, 24)), col="blue", alpha=0.5) +
geom_line(mapping=aes(y=lag(`Fed_Rate`, 1)), col="green", alpha=0.5) +
geom_line(mapping=aes(y=`Inf_Rate`), col="red", alpha=0.5) +
theme_bw()
ggplot(data=cpi_1950, mapping=aes(x=1:length(lag(`Fed_Rate`, 24)))) +
geom_line(mapping=aes(y=lag(`Fed_Rate`, 24)), col="darkblue", alpha=0.5) +
geom_line(mapping=aes(y=lag(`Fed_Rate`, 1)), col="darkgreen", alpha=0.5) +
geom_line(mapping=aes(y=`Inf_Rate`), col="red", alpha=0.5) +
theme_bw()
ggplot(data=cpi_1950, mapping=aes(x=1:length(lag(`Fed_Rate`, 48)))) +
geom_line(mapping=aes(y=lag(`Fed_Rate`, 48)), col="darkblue", alpha=0.5) +
geom_line(mapping=aes(y=lag(`Fed_Rate`, 1)), col="darkgreen", alpha=0.5) +
geom_line(mapping=aes(y=`Inf_Rate`), col="red", alpha=0.5) +
theme_bw()
ggplot(data=cpi_1950, mapping=aes(x=1:length(lag(`Fed_Rate`, 48)))) +
geom_line(mapping=aes(y=lag(`Fed_Rate`, 48)), col="darkblue", alpha=0.5) +
geom_line(mapping=aes(y=lag(`Fed_Rate`, 1)), col="darkgreen", alpha=0.25) +
geom_line(mapping=aes(y=`Inf_Rate`), col="red", alpha=0.5) +
theme_bw()
plot(lag(cpi_1950$Fed_Rate, 48), cpi_1950$Inf_Rate)
cor(lag(cpi_1950$Fed_Rate, 48), cpi_1950$Inf_Rate)
cor(lag(cpi_1950$Fed_Rate, 48), cpi_1950$Inf_Rate)
cor(cpi_1950$Fed_Rate, cpi_1950$Inf_Rate)
cor(lag(cpi_1950$Fed_Rate, 48), cpi_1950$Inf_Rate[48:length(cpi_1950$Inf_Rate)])
cor(lag(cpi_1950$Fed_Rate, 48), cpi_1950$Inf_Rate[47:length(cpi_1950$Inf_Rate)])
cor(lag(cpi_1950$Fed_Rate, 48), cpi_1950$Inf_Rate)
cor(lag(cpi_1950$Fed_Rate, 48), cpi_1950$Inf_Rate, use = "complete.obs")
cor(lag(cpi_1950$Fed_Rate, 24), cpi_1950$Inf_Rate, use = "complete.obs")
cor(lag(cpi_1950$Fed_Rate, 100), cpi_1950$Inf_Rate, use = "complete.obs")
cor(lag(cpi_1950$Fed_Rate, 124), cpi_1950$Inf_Rate, use = "complete.obs")
cor(lag(cpi_1950$Fed_Rate, 100), cpi_1950$Inf_Rate, use = "complete.obs")
cor(lag(cpi_1950$Fed_Rate, 10), cpi_1950$Inf_Rate, use = "complete.obs")
cor(lag(cpi_1950$Fed_Rate, 1), cpi_1950$Inf_Rate, use = "complete.obs")
cor(lag(cpi_1950$Fed_Rate, 5), cpi_1950$Inf_Rate, use = "complete.obs")
cor(lag(cpi_1950$Fed_Rate, 72), cpi_1950$Inf_Rate, use = "complete.obs")
cor(lag(cpi_1950$Fed_Rate, 96), cpi_1950$Inf_Rate, use = "complete.obs")
cor(lag(cpi_1950$Fed_Rate, 108), cpi_1950$Inf_Rate, use = "complete.obs")
cor(lag(cpi_1950$Fed_Rate, 120), cpi_1950$Inf_Rate, use = "complete.obs")
cor(lag(cpi_1950$Fed_Rate, 132), cpi_1950$Inf_Rate, use = "complete.obs")
cor(lag(cpi_1950$Fed_Rate, 132), cpi_1950$Inf_Rate, use = "complete.obs")
cor(lag(cpi_1950$Fed_Rate, 48), cpi_1950$Inf_Rate, use = "complete.obs")
cor(lag(cpi_full$Fed_Rate, 48), cpi_full$Inf_Rate, use = "complete.obs")
cor(lag(cpi_full$Fed_Rate, 24), cpi_full$Inf_Rate, use = "complete.obs")
cor(lag(cpi_full$Fed_Rate, 1), cpi_full$Inf_Rate, use = "complete.obs")
cor(lag(cpi_full$Fed_Rate, 72), cpi_full$Inf_Rate, use = "complete.obs")
cor(lag(cpi_full$Fed_Rate, 100), cpi_full$Inf_Rate, use = "complete.obs")
cor(lag(cpi_full$Fed_Rate, 120), cpi_full$Inf_Rate, use = "complete.obs")
cor(lag(cpi_full$Fed_Rate, 60), cpi_full$Inf_Rate, use = "complete.obs")
cor(lag(cpi_full$Fed_Rate, 120), cpi_full$Inf_Rate, use = "complete.obs")
plot(lag(cpi_full$Fed_Rate, 120), cpi_full$Inf_Rate)
cor(lag(cpi_full$Fed_Rate, 120), cpi_full$Inf_Rate, use = "complete.obs")
plot(lag(cpi_1950$Fed_Rate, 120), cpi_1950$Inf_Rate)
cor(lag(cpi_1950$Fed_Rate, 120), cpi_1950$Inf_Rate, use = "complete.obs")
cor(lag(cpi_1950$Fed_Rate, 60), cpi_1950$Inf_Rate, use = "complete.obs")
plot(lag(cpi_1950$Fed_Rate, 60), cpi_1950$Inf_Rate)
plot(lag(cpi_1950$Fed_Rate, 40), cpi_1950$Inf_Rate)
cor(lag(cpi_1950$Fed_Rate, 40), cpi_1950$Inf_Rate, use = "complete.obs")
plot(lag(cpi_1950$Fed_Rate, 48), cpi_1950$Inf_Rate)
cor(lag(cpi_1950$Fed_Rate, 48), cpi_1950$Inf_Rate, use = "complete.obs")
plot(lag(cpi_1950$Fed_Rate, 48), cpi_1950$Inf_Rate, col=ifelse(cpi_1950$Year>1990, "blue", "red"))
plot(lag(cpi_1950$Fed_Rate, 48), cpi_1950$Inf_Rate, col=ifelse(cpi_1950$Year>2000, "blue", "red"))
cor(lag(cpi_1950$Fed_Rate, 48), cpi_1950$Inf_Rate, use = "complete.obs")
plot(lag(cpi_1950$Fed_Rate, 48), cpi_1950$Inf_Rate, col=ifelse(cpi_1950$Year>1990, "blue", "red"))
plot(lag(cpi_1950$Fed_Rate, 48), cpi_1950$Inf_Rate, col=ifelse(cpi_1950$Year>2000, "blue", "red"))
cor(lag(cpi_1950$Fed_Rate, 48), cpi_1950$Inf_Rate, use = "complete.obs")
plot(lag(cpi_1950$Fed_Rate, 48), cpi_1950$Inf_Rate, col=ifelse(cpi_1950$Year>1980, "blue", "red"))
plot(lag(cpi_1950$Fed_Rate, 48), cpi_1950$Inf_Rate, col=ifelse(cpi_1950$Year>1990, "blue", "red"))
plot(lag(cpi_1950$Fed_Rate, 48), cpi_1950$Inf_Rate, col=ifelse(cpi_1950$Year>1995, "blue", "red"))
plot(lag(cpi_1950$Fed_Rate, 48), cpi_1950$Inf_Rate, col=ifelse(cpi_1950$Year>1990, "blue", "red"))
plot(lag(cpi_1950$Fed_Rate, 48), cpi_1950$Inf_Rate, col=ifelse(cpi_1950$Year>2000, "blue", "red"))
plot(lag(cpi_1950$Fed_Rate, 48), cpi_1950$Inf_Rate, col=ifelse(cpi_1950$Year<2000, "blue", "red"))
ggplot(data=cpi_1950, mapping=aes(x=1:length(lag(`Fed_Rate`, 48)))) +
geom_line(mapping=aes(y=lag(`Fed_Rate`, 48)), col="darkblue", alpha=0.5) +
geom_line(mapping=aes(y=lag(`Fed_Rate`, 1)), col="darkgreen", alpha=0.25) +
geom_line(mapping=aes(y=`Inf_Rate`), col="red", alpha=0.5) +
theme_bw()
ggplot(data=cpi_1950, mapping=aes(x=lag(`Year`, 48))) +
geom_line(mapping=aes(y=lag(`Fed_Rate`, 48)), col="darkblue", alpha=0.5) +
geom_line(mapping=aes(y=lag(`Fed_Rate`, 1)), col="darkgreen", alpha=0.25) +
geom_line(mapping=aes(y=`Inf_Rate`), col="red", alpha=0.5) +
theme_bw()
ggplot(data=cpi_1950, mapping=aes(x=lag(`Month`, 48))) +
geom_line(mapping=aes(y=lag(`Fed_Rate`, 48)), col="darkblue", alpha=0.5) +
geom_line(mapping=aes(y=lag(`Fed_Rate`, 1)), col="darkgreen", alpha=0.25) +
geom_line(mapping=aes(y=`Inf_Rate`), col="red", alpha=0.5) +
theme_bw()
1:length(
ggplot(data=cpi_1950, mapping=aes(x=1:length(lag(`Fed_Rate`, 48)))) +
geom_line(mapping=aes(y=lag(`Fed_Rate`, 48)), col="darkblue", alpha=0.5) +
geom_line(mapping=aes(y=lag(`Fed_Rate`, 1)), col="darkgreen", alpha=0.25) +
geom_line(mapping=aes(y=`Inf_Rate`), col="red", alpha=0.5) +
theme_bw()
ggplot(data=cpi_1950, mapping=aes(x=1:length(lag(`Fed_Rate`, 48)))) +
geom_line(mapping=aes(y=lag(`Fed_Rate`, 48)), col="darkblue", alpha=0.5) +
geom_line(mapping=aes(y=lag(`Fed_Rate`, 1)), col="darkgreen", alpha=0.25) +
geom_line(mapping=aes(y=`Inf_Rate`), col="red", alpha=0.5) +
theme_bw()
ggplot(data=cpi_1950, mapping=aes(x=1:length(lag(`Fed_Rate`, 48)))) +
geom_line(mapping=aes(y=lag(`Fed_Rate`, 48)), col="darkblue", alpha=0.5) +
geom_line(mapping=aes(y=lag(`Fed_Rate`, 1)), col="darkgreen", alpha=0.25) +
geom_line(mapping=aes(y=`Inf_Rate`), col="red", alpha=0.5) +
theme_bw()
plot(lag(cpi_1950$Fed_Rate, 48), cpi_1950$Inf_Rate, col=ifelse(cpi_1950$Year<2000, "blue", "red"))
plot(lag(cpi_1950$Fed_Rate, 48), cpi_1950$Inf_Rate, col=ifelse(cpi_1950$Year<2010, "blue", "red"))
cor(lag(cpi_1950$Fed_Rate, 48), cpi_1950$Inf_Rate, use = "complete.obs")
plot(lag(cpi_1950$Fed_Rate, 48), cpi_1950$Inf_Rate, col=ifelse(cpi_1950$Year<2020, "blue", "red"))
plot(lag(cpi_1950$Fed_Rate, 48), cpi_1950$Inf_Rate, col=ifelse(cpi_1950$Year<2010, "blue", "red"))
plot(lag(cpi_1950$Fed_Rate, 48), cpi_1950$Inf_Rate, col=ifelse(cpi_1950$Year<2000, "blue", "red"))
plot(lag(cpi_1950$Fed_Rate, 48), cpi_1950$Inf_Rate, col=ifelse(cpi_1950$Year<1990, "blue", "red"))
plot(lag(cpi_1950$Fed_Rate, 48), cpi_1950$Inf_Rate, col=ifelse(cpi_1950$Year<1980, "blue", "red"))
plot(lag(cpi_1950$Fed_Rate, 48), cpi_1950$Inf_Rate, col=ifelse(cpi_1950$Year<1970, "blue", "red"))
plot(lag(cpi_1950$Fed_Rate, 48), cpi_1950$Inf_Rate, col=ifelse(cpi_1950$Year<1980, "blue", "red"))
plot(lag(cpi_1950$Fed_Rate, 48), cpi_1950$Inf_Rate, col=ifelse(cpi_1950$Year<1990, "blue", "red"))
plot(lag(cpi_1950$Fed_Rate, 48), cpi_1950$Inf_Rate, col=ifelse(cpi_1950$Year<2000, "blue", "red"))
plot(lag(cpi_1950$Fed_Rate, 1), cpi_1950$Inf_Rate, col=ifelse(cpi_1950$Year<2000, "blue", "red"))
cor(lag(cpi_1950$Fed_Rate, 48), cpi_1950$Inf_Rate, use = "complete.obs")
View(cpi_1950)
plot(lag(cpi_1950$Fed_Rate, 1), cpi_1950$Inf_Rate, col=ifelse(cpi_1950$Year<1960, "blue", "red"))
plot(lag(cpi_1950$Fed_Rate, 1), cpi_1950$Inf_Rate, col=ifelse(cpi_1950$Year<1965, "blue", "red"))
plot(lag(cpi_1950$Fed_Rate, 1), cpi_1950$Inf_Rate, col=ifelse(cpi_1950$Year<1970, "blue", "red"))
plot(lag(cpi_1950$Fed_Rate, 1), cpi_1950$Inf_Rate, col=ifelse(cpi_1950$Year<1980, "blue", "red"))
plot(lag(cpi_1950$Fed_Rate, 1), cpi_1950$Inf_Rate, col=ifelse(cpi_1950$Year<1990, "blue", "red"))
plot(lag(cpi_1950$Fed_Rate, 1), cpi_1950$Inf_Rate, col=ifelse(cpi_1950$Year<2000, "blue", "red"))
plot(lag(cpi_1950$Fed_Rate, 48), cpi_1950$Inf_Rate, col=ifelse(cpi_1950$Year<2000, "blue", "red"))
cor(lag(cpi_1950$Fed_Rate, 48), cpi_1950$Inf_Rate, use = "complete.obs")
ggplot(data=cpi_1950, mapping=aes(x=1:length(lag(`Fed_Rate`, 48)))) +
geom_line(mapping=aes(y=lag(`Fed_Rate`, 48)), col="darkblue", alpha=0.5) +
geom_line(mapping=aes(y=lag(`Fed_Rate`, 1)), col="darkgreen", alpha=0.25) +
geom_line(mapping=aes(y=`Inf_Rate`), col="red", alpha=0.5) +
theme_bw()
summary(fit)
summary(auto.arima(cpi_1950$Inf_Rate, xreg=as.matrix(cpi_1950[4:6])))
View(cpi_1950)
View(cpi_full)
summary(auto.arima(cpi_full$Inf_Rate, xreg=as.matrix(cpi_full[4:8])))
autoplot(forecast(fit, h=30))
summary(fit)
summary(auto.arima(cpi_full$Inf_Rate, xreg=as.matrix(cpi_full[4:8])))
summary(auto.arima(cpi_1950$Inf_Rate, xreg=as.matrix(cpi_1950[4:6])))
summary(auto.arima(cpi_full$Inf_Rate, xreg=as.matrix(cpi_full[4:8])))
fit1 <- auto.arima(cpi_full$Inf_Rate)
summary(fit1)
autoplot(forecast(fit1, h=30))
fit2 <- auto.arima(cpi_1950$Inf_Rate, xreg=as.matrix(cpi_1950[4:6]))
summary(fit2)
fit3 <- auto.arima(cpi_full$Inf_Rate, xreg=as.matrix(cpi_full[4:8]))
summary(fit3)
plot(fit3)
autoplot(fit3)
mat <- matrix(c(1, 0, 0), c(1, 2, 0), c(0, 2, 3), byrow = TRUE)
mat <- matrix(ncol=3, nrow=3, c(1, 0, 0), c(1, 2, 0), c(0, 2, 3), byrow = TRUE)
mat <- matrix(ncol=3, nrow=3, data= c(1, 0, 0, 1, 2, 0, 0, 2, 3), byrow = TRUE)
View(mat)
eigen(mat)
mat <- matrix(c(1, 2, 0, 1))
View(mat)
mat <- matrix(c(1, 2, 0, 1), ncol=2)
View(mat)
eigen(mat)
mat <- matrix(c(1, 2, 0, 1), ncol=2, byrow=TRUE)
eigen(mat)
View(mat)
data <- CO2
View(data)
null_lm <- lm(data=CO2, formula=uptake~1)
full_lm <- lm(data=CO2, formula=uptake~.)
summary(full_lm)
step_lm <- step(null_lm, scope=full_lm$terms)
summary(step_lm)
u_1 <- runif(1000000)
u_2 <- runif(1000000)
func_sample <- 8*u_2*sqrt(1-u_1^2)
mean(func_sample)
u_1 <- runif(10000000)
u_2 <- runif(10000000)
func_sample <- 8*u_2*sqrt(1-u_1^2)
mean(func_sample)
pi
u_1 <- runif(1000000)
u_2 <- runif(1000000)
func_sample <- 8*u_2*sqrt(1-u_1^2)
mean(func_sample)
qnorm(0.975)
x_bar <- mean(func_sample)
s_n <- sum(func_sample)
n <- length(func_sample)
conf_int <- c(-1,1)*(qnorm(0.975)*s_n)/sqrt(n)
conf_int <- c(-1,1)*((qnorm(0.975)*s_n)/sqrt(n))
conf_int <- c(-1,1)*((qnorm(0.975)*x_bar)/sqrt(n))
conf_int <- x_bar+c(-1,1)*((qnorm(0.975)*s_n)/sqrt(n))
s_n <- var(func_sample)
n <- length(func_sample)
conf_int <- x_bar+c(-1,1)*((qnorm(0.975)*s_n)/sqrt(n))
paste(conf_int)
u_1 <- runif(100000000)
u_2 <- runif(100000000)
func_sample <- 8*u_2*sqrt(1-u_1^2)
x_bar <- mean(func_sample)
s_n <- var(func_sample)
n <- length(func_sample)
conf_int <- x_bar+c(-1,1)*((qnorm(0.975)*s_n)/sqrt(n))
paste(conf_int)
u_1 <- runif(1000000)
u_2 <- runif(1000000)
func_sample <- 8*u_2*sqrt(1-u_1^2)
x_bar <- mean(func_sample)
s_n <- var(func_sample)
n <- length(func_sample)
conf_int <- x_bar+c(-1,1)*((qnorm(0.975)*s_n)/sqrt(n))
paste(conf_int)
u_1 <- runif(1000000)
u_2 <- runif(1000000)
func_sample <- 8*u_2*sqrt(1-u_1^2)
x_bar <- mean(func_sample)
s_n <- var(func_sample)
n <- length(func_sample)
conf_int <- x_bar+c(-1,1)*((qnorm(0.975)*s_n)/sqrt(n))
paste(conf_int)
u_1 <- runif(1000000)
u_2 <- runif(1000000)
func_sample <- 8*u_2*sqrt(1-u_1^2)
x_bar <- mean(func_sample)
s_n <- var(func_sample)
n <- length(func_sample)
conf_int <- x_bar+c(-1,1)*((qnorm(0.975)*s_n)/sqrt(n))
paste(conf_int)
u_1 <- runif(1000000)
u_2 <- runif(1000000)
func_sample <- 8*u_2*sqrt(1-u_1^2)
x_bar <- mean(func_sample)
s_n <- var(func_sample)
n <- length(func_sample)
conf_int <- x_bar+c(-1,1)*((qnorm(0.975)*s_n)/sqrt(n))
paste(conf_int)
u_1 <- runif(1000000)
u_2 <- runif(1000000)
func_sample <- 8*u_2*sqrt(1-u_1^2)
x_bar <- mean(func_sample)
s_n <- var(func_sample)
n <- length(func_sample)
conf_int <- x_bar+c(-1,1)*((qnorm(0.975)*s_n)/sqrt(n))
paste(conf_int)
u_1 <- runif(1000000)
u_2 <- runif(1000000)
func_sample <- 8*u_2*sqrt(1-u_1^2)
x_bar <- mean(func_sample)
s_n <- var(func_sample)
n <- length(func_sample)
conf_int <- x_bar+c(-1,1)*((qnorm(0.975)*s_n)/sqrt(n))
paste(conf_int)
22/7
library(readr)
library(dplyr)
library(tidyr)
library(stringr)
library(lubridate)
library(purrr)
library(ggplot2)
library(car)
library(forecast)
library(vars)
library(gganimate)
library(psych)
library(corrplot)
library(ragg)
Monthly_Inflation <- read_csv("Monthly Inflation Rate All.csv")
setwd("~/College Work/2022-2023/STAT410/Final Project")
Monthly_Inflation <- read_csv("Monthly Inflation Rate All.csv")
WTI_Oil_Prices <- read_csv("WTISPLC.csv")
FEDFUNDS <- read_csv("FEDFUNDS.csv")
Monthly_Unemployment <- read_csv("Monthly Unemployment.csv")
AllCommodities_Index <- read_csv("AllCommodities_Change.csv")
UMCSENT <- read_csv("UMCSENT.csv")
M2SL <- read_csv("CURRSL.csv")
M2SL$DATE <- mdy(M2SL$DATE)
M2SL$Year <- year(M2SL$DATE)
M2SL$Month <- month(M2SL$DATE)
M2SL <- subset(M2SL, select=-c(DATE, CURRSL))
M2SL <- drop_na(M2SL)
M2SL$M1_Change <- ts(M2SL$M1_Change * 100, start=1948, frequency = 12)
autoplot(M2SL$M1_Change) + theme_bw() + labs(title="U.S. M1 Money Supply",
subtitle=("Data from Jan. 1948 to Sep. 2022"),
y="Annualized Percent Change (%)",
caption="Source: St. Louis Federal Reserve Economic Data")
gglagplot(M2SL$M1_Change) + theme_bw() + labs(title="Money Supply")
plot(decompose(M2SL$M1_Change))
ggseasonplot(M2SL$M1_Change, polar=T, col=hcl.colors(75, alpha=0.8)) +
theme_bw() + labs(title="Money Supply Seasonal Plot") + theme(text=element_text(size=20))
unemployment_long <- Monthly_Unemployment %>%
gather(Month, Unemployment, Jan:Dec)
unemployment_long$Month <- match(unemployment_long$Month, month.abb)
unemployment_long <- unemployment_long %>%
group_by(Year) %>%
arrange(Year, Month)
unemployment_long$Unemployment <- ts(unemployment_long$Unemployment, start=1948, frequency=12)
autoplot(unemployment_long$Unemployment)+ theme_bw() + labs(title="United States Unemployment Rate",
subtitle=("Data from Jan. 1948 to Sep. 2022"),
y="% of Labor Force Unemployed",
caption="Source: Bureau of Labor Statistics")
gglagplot(unemployment_long$Unemployment) + theme_bw() + labs(title="Unemployment Rate")
plot(decompose(unemployment_long$Unemployment))
ggseasonplot(unemployment_long$Unemployment, polar=T, col=hcl.colors(80, alpha=0.8)) +
theme_bw() + labs(title="Unemployment Seasonal Plot") + theme(text=element_text(size=20))
UMCSENT$DATE <- ymd(UMCSENT$DATE)
UMCSENT$Year <- year(UMCSENT$DATE)
UMCSENT$Month <- month(UMCSENT$DATE)
UMCSENT <- subset(UMCSENT, select=-c(DATE))
UMCSENT$UMCSENT <- as.numeric(ifelse(UMCSENT$UMCSENT==".",NaN,UMCSENT$UMCSENT))
UMCSENT <- UMCSENT %>%
mutate(UMCSENT = na.approx(UMCSENT))
UMCSENT$UMCSENT <- ts(UMCSENT$UMCSENT, start=1958, frequency = 12)
autoplot(UMCSENT$UMCSENT) + theme_bw() + labs(title="United States Consumer Sentiment",
subtitle=("Data from Nov. 1952 to Aug. 2022"),
y="Consumer Sentiment Index", caption="Source: University of Michigan")
gglagplot(UMCSENT$UMCSENT) + theme_bw() + labs(title="Consumer Sentiment Index")
plot(decompose(UMCSENT$UMCSENT))
ggseasonplot(UMCSENT$UMCSENT, polar=T, col=hcl.colors(80, alpha=0.8)) +
theme_bw() + labs(title="Consumer Sentiment Seasonal Plot") + theme(text=element_text(size=20))
commodities_long <- AllCommodities_Index %>%
gather(Month, Commodities_Price, Jan:Dec)
commodities_long$Month <- match(commodities_long$Month, month.abb)
commodities_long <- commodities_long %>%
group_by(Year) %>%
arrange(Year, Month)
commodities_long$Commodities_Price <- ts(commodities_long$Commodities_Price * 100, start=1947, frequency=12)
autoplot(commodities_long$Commodities_Price) + theme_bw() + labs(title="Price Index for All Commodities",
subtitle=("Data from Jan. 1947 to Sep. 2022"),
y="Annualized Percent Change (%)",
caption="Source: Bureau of Labor Statistics")
gglagplot(commodities_long$Commodities_Price) + theme_bw() + labs(title="Commodities Price Index")
plot(decompose(commodities_long$Commodities_Price))
ggseasonplot(commodities_long$Commodities_Price, polar=T, col=hcl.colors(80, alpha=0.8)) +
theme_bw() + labs(title="Commodities Price Seasonal Plot") + theme(text=element_text(size=20))
FEDFUNDS$DATE <- ymd(FEDFUNDS$DATE)
FEDFUNDS$Year <- year(FEDFUNDS$DATE)
FEDFUNDS$Month <- month(FEDFUNDS$DATE)
FEDFUNDS <- subset(FEDFUNDS[FEDFUNDS$Year>1954,], select=-c(DATE))
FEDFUNDS$FEDFUNDS <- ts(FEDFUNDS$FEDFUNDS, start=1955, frequency=12)
autoplot(FEDFUNDS$FEDFUNDS) + theme_bw() + labs(title="Federal Funds Rate",
subtitle=("Data from July. 1954 to Sep. 2022"),
y="Federal Funds Rate",
caption="Source: St. Louis Federal Reserve Economic Data")
gglagplot(FEDFUNDS$FEDFUNDS) + theme_bw() + labs(title="Federal Funds Rate")
plot(decompose(FEDFUNDS$FEDFUNDS))
ggseasonplot(FEDFUNDS$FEDFUNDS, polar=T, col=hcl.colors(70, alpha=0.8)) +
theme_bw() + labs(title="Federal Funds Rate Seasonal Plot") + theme(text=element_text(size=20))
WTI_Oil_Prices$DATE <- mdy(WTI_Oil_Prices$DATE)
WTI_Oil_Prices$Year <- year(WTI_Oil_Prices$DATE)
WTI_Oil_Prices$Month <- month(WTI_Oil_Prices$DATE)
WTI_Oil_Prices <- subset(WTI_Oil_Prices, select=-c(DATE, WTISPLC))
WTI_Oil_Prices <- WTI_Oil_Prices %>%
group_by(Year) %>%
arrange(Year, Month)
WTI_Oil_Prices$Oil_Change <- ts(WTI_Oil_Prices$Oil_Change * 100, start=1946, frequency=12)
autoplot(WTI_Oil_Prices$Oil_Change) + theme_bw() + labs(title="Crude Oil Price Index",
subtitle=("Data from Jan. 1946 to Oct. 2022"),
y="Annualized Percent Change (%)",
caption="Source: St. Louis Federal Reserve Economic Data")
gglagplot(WTI_Oil_Prices$Oil_Change) + theme_bw() + labs(title="Oil Price Index")
plot(decompose(WTI_Oil_Prices$Oil_Change))
ggseasonplot(WTI_Oil_Prices$Oil_Change, polar=T, col=hcl.colors(80, alpha=0.8)) +
theme_bw() + labs(title="Crude Oil Price Seasonal Plot") + theme(text=element_text(size=20))
inflation_long <- gather(Monthly_Inflation, Month, Rate, Jan:Dec)
inflation_long$Month <- match(inflation_long$Month, month.abb)
inflation_long <- inflation_long %>%
group_by(Year) %>%
arrange(Year, Month)
inflation_long$Rate <- ts(inflation_long$Rate, start=1950, frequency=12)
autoplot(inflation_long$Rate) + theme_bw() + labs(title="U.S. Inflation Rate",
subtitle=("Data from Jan. 1950 to Oct. 2022"),
y="Inflation Rate",
caption="Source: St. Louis Federal Reserve Economic Data")
ggseasonplot(inflation_long$Rate, polar=T, col=hcl.colors(80, alpha=0.8)) +
theme_bw() + labs(title="Inflation Rate Seasonal Plot") + theme(text=element_text(size=20))
gglagplot(inflation_long$Rate) + theme_bw() + labs(title="Inflation Rate")
ggAcf(inflation_long$Rate)
cpi_full <- merge(inflation_long, FEDFUNDS, by=c("Year", "Month")) %>%
merge(M2SL, by=c("Year", "Month")) %>%
merge(unemployment_long, by=c("Year", "Month")) %>%
merge(UMCSENT, by=c("Year", "Month")) %>%
merge(commodities_long, by=c("Year", "Month")) %>%
merge(WTI_Oil_Prices, by=c("Year", "Month")) %>%
group_by(Year) %>%
arrange(Year, Month)
colnames(cpi_full) <- c("Year", "Month", "Inf_Rate", "Fed_Rate", "MS_Pct_Change", "Unemployment", "Consumer_Sentiment", "Oil_Price_Index", "Commodities_Index")
cpi_full$Date <- mdy(paste(cpi_full$Month, "1", cpi_full$Year, sep="/"))
# Training and Testing Sets
cpi_full_train <- cpi_full[1:(length(cpi_full$Year)-60),]
cpi_full_test <- cpi_full[(length(cpi_full$Year)-60+1):length(cpi_full$Year),]
